<Window x:Class="PIDStandardization.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="P&amp;ID Standardization Application" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Menu Grid.Row="0">
            <MenuItem Header="_File">
                <MenuItem Header="_New Project" Click="NewProject_Click"/>
                <MenuItem Header="_Open Project" Click="OpenProject_Click"/>
                <Separator/>
                <MenuItem Header="_Exit" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Project">
                <MenuItem Header="_Settings"/>
                <MenuItem Header="_Tagging Mode"/>
            </MenuItem>
            <MenuItem Header="_Equipment">
                <MenuItem Header="_Add Equipment"/>
                <MenuItem Header="_Tag Equipment"/>
                <Separator/>
                <MenuItem Header="_Tag Renumbering Wizard" Click="TagRenumberingWizard_Click"/>
            </MenuItem>
            <MenuItem Header="_Drawings">
                <MenuItem Header="_Import Drawing"/>
                <MenuItem Header="_Manage Drawings"/>
            </MenuItem>
            <MenuItem Header="_Validation">
                <MenuItem Header="_Run Validation"/>
                <MenuItem Header="_Configure Rules"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_User Guide" Click="UserGuide_Click"/>
                <MenuItem Header="_Welcome Screen" Click="WelcomeScreen_Click"/>
                <MenuItem Header="_Quick Start Guide" Click="QuickStartGuide_Click"/>
                <MenuItem Header="_Documentation" Click="Documentation_Click"/>
                <Separator/>
                <MenuItem Header="_About" Click="About_Click"/>
            </MenuItem>
        </Menu>

        <!-- Main Content Area -->
        <TabControl Grid.Row="1" Margin="5" Name="MainTabControl" SelectionChanged="MainTabControl_SelectionChanged">
            <!-- Dashboard Tab -->
            <TabItem Header="Dashboard">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="DashboardProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="DashboardProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,10,0"/>
                            <TextBlock Grid.Column="1" Name="DashboardProjectTaggingModeTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,10,0"/>
                            <Button Grid.Column="2" Content="Refresh Dashboard" Width="130" Height="25"
                                    Click="RefreshDashboard_Click"/>
                        </Grid>
                    </GroupBox>

                    <!-- Dashboard Content -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <Grid Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Statistics Cards -->
                            <UniformGrid Grid.Row="0" Columns="4" Margin="0,0,0,15">
                                <!-- Total Equipment Card -->
                                <Border Background="#4CAF50" CornerRadius="5" Margin="5" Padding="15">
                                    <StackPanel>
                                        <TextBlock Text="Total Equipment" FontSize="14" Foreground="White" FontWeight="SemiBold"/>
                                        <TextBlock Name="TotalEquipmentTextBlock" Text="0" FontSize="32" Foreground="White" FontWeight="Bold" Margin="0,10,0,0"/>
                                        <TextBlock Name="TotalEquipmentSubtitleTextBlock" Text="items in project" FontSize="11" Foreground="WhiteSmoke"/>
                                    </StackPanel>
                                </Border>

                                <!-- Tagged Equipment Card -->
                                <Border Background="#2196F3" CornerRadius="5" Margin="5" Padding="15">
                                    <StackPanel>
                                        <TextBlock Text="Tagged Equipment" FontSize="14" Foreground="White" FontWeight="SemiBold"/>
                                        <TextBlock Name="TaggedEquipmentTextBlock" Text="0" FontSize="32" Foreground="White" FontWeight="Bold" Margin="0,10,0,0"/>
                                        <TextBlock Name="TaggedEquipmentPercentTextBlock" Text="0% complete" FontSize="11" Foreground="WhiteSmoke"/>
                                    </StackPanel>
                                </Border>

                                <!-- Lines Card -->
                                <Border Background="#FF9800" CornerRadius="5" Margin="5" Padding="15">
                                    <StackPanel>
                                        <TextBlock Text="Total Lines" FontSize="14" Foreground="White" FontWeight="SemiBold"/>
                                        <TextBlock Name="TotalLinesTextBlock" Text="0" FontSize="32" Foreground="White" FontWeight="Bold" Margin="0,10,0,0"/>
                                        <TextBlock Name="TotalLinesSubtitleTextBlock" Text="process lines" FontSize="11" Foreground="WhiteSmoke"/>
                                    </StackPanel>
                                </Border>

                                <!-- Instruments Card -->
                                <Border Background="#9C27B0" CornerRadius="5" Margin="5" Padding="15">
                                    <StackPanel>
                                        <TextBlock Text="Total Instruments" FontSize="14" Foreground="White" FontWeight="SemiBold"/>
                                        <TextBlock Name="TotalInstrumentsTextBlock" Text="0" FontSize="32" Foreground="White" FontWeight="Bold" Margin="0,10,0,0"/>
                                        <TextBlock Name="TotalInstrumentsSubtitleTextBlock" Text="instruments" FontSize="11" Foreground="WhiteSmoke"/>
                                    </StackPanel>
                                </Border>
                            </UniformGrid>

                            <!-- Charts and Breakdown -->
                            <Grid Grid.Row="1" Margin="0,0,0,15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Equipment by Type -->
                                <GroupBox Grid.Column="0" Header="Equipment by Type" Margin="5" Padding="10">
                                    <ListView Name="EquipmentByTypeListView" BorderThickness="0">
                                        <ListView.View>
                                            <GridView>
                                                <GridViewColumn Header="Equipment Type" Width="180" DisplayMemberBinding="{Binding Type}"/>
                                                <GridViewColumn Header="Count" Width="80" DisplayMemberBinding="{Binding Count}"/>
                                                <GridViewColumn Header="Percentage" Width="100" DisplayMemberBinding="{Binding Percentage}"/>
                                            </GridView>
                                        </ListView.View>
                                    </ListView>
                                </GroupBox>

                                <!-- Equipment by Status -->
                                <GroupBox Grid.Column="1" Header="Equipment by Status" Margin="5" Padding="10">
                                    <ListView Name="EquipmentByStatusListView" BorderThickness="0">
                                        <ListView.View>
                                            <GridView>
                                                <GridViewColumn Header="Status" Width="180" DisplayMemberBinding="{Binding Status}"/>
                                                <GridViewColumn Header="Count" Width="80" DisplayMemberBinding="{Binding Count}"/>
                                                <GridViewColumn Header="Percentage" Width="100" DisplayMemberBinding="{Binding Percentage}"/>
                                            </GridView>
                                        </ListView.View>
                                    </ListView>
                                </GroupBox>
                            </Grid>

                            <!-- Recent Activity and Quick Actions -->
                            <Grid Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Recent Equipment -->
                                <GroupBox Grid.Column="0" Header="Recently Added Equipment (Last 10)" Margin="5" Padding="10">
                                    <ListView Name="RecentEquipmentListView" BorderThickness="0">
                                        <ListView.View>
                                            <GridView>
                                                <GridViewColumn Header="Tag Number" Width="120" DisplayMemberBinding="{Binding TagNumber}"/>
                                                <GridViewColumn Header="Type" Width="120" DisplayMemberBinding="{Binding EquipmentType}"/>
                                                <GridViewColumn Header="Description" Width="200" DisplayMemberBinding="{Binding Description}"/>
                                                <GridViewColumn Header="Date Added" Width="140" DisplayMemberBinding="{Binding CreatedDate, StringFormat='{}{0:yyyy-MM-dd HH:mm}'}"/>
                                            </GridView>
                                        </ListView.View>
                                    </ListView>
                                </GroupBox>

                                <!-- Quick Actions -->
                                <GroupBox Grid.Column="1" Header="Quick Actions" Margin="5" Padding="10">
                                    <StackPanel>
                                        <Button Content="Add Equipment" Height="35" Margin="0,5" Click="AddEquipment_Click" Background="LightGreen"/>
                                        <Button Content="Import from Excel" Height="35" Margin="0,5" Click="ImportEquipment_Click" Background="LightBlue"/>
                                        <Button Content="Export to Excel" Height="35" Margin="0,5" Click="ExportEquipment_Click" Background="LightYellow"/>
                                        <Button Content="Manage Drawings" Height="35" Margin="0,5" Click="ManageDrawings_Click" Background="LightCoral"/>
                                        <Button Content="Run Validation" Height="35" Margin="0,5" Click="RunValidation_Click" Background="LightSalmon"/>
                                        <Separator Margin="0,10"/>
                                        <TextBlock Text="Project Information" FontWeight="Bold" Margin="0,5"/>
                                        <TextBlock Name="DashboardProjectInfoTextBlock" TextWrapping="Wrap" Margin="0,5"/>
                                    </StackPanel>
                                </GroupBox>
                            </Grid>
                        </Grid>
                    </ScrollViewer>
                </Grid>
            </TabItem>

            <TabItem Header="Equipment">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="EquipmentProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="EquipmentProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="EquipmentProjectTaggingModeTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                        <Button Content="Add Equipment" Width="120" Height="30" Margin="5" Click="AddEquipment_Click"/>
                        <Button Content="Edit Equipment" Width="120" Height="30" Margin="5" Click="EditEquipment_Click"/>
                        <Button Content="Delete Equipment" Width="130" Height="30" Margin="5" Click="DeleteEquipment_Click"/>
                        <Button Content="Import from Excel" Width="130" Height="30" Margin="5" Click="ImportEquipment_Click" Background="LightGreen"/>
                        <Button Content="Export to Excel" Width="120" Height="30" Margin="5" Click="ExportEquipment_Click"/>
                        <Button Content="Download Template" Width="130" Height="30" Margin="5" Click="DownloadEquipmentTemplate_Click" Background="LightYellow"/>
                        <Button Content="Refresh" Width="80" Height="30" Margin="5" Click="RefreshEquipment_Click"/>
                    </StackPanel>

                    <!-- Equipment Grid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="EquipmentDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Tag Number" Binding="{Binding TagNumber}" Width="150"/>
                            <DataGridTextColumn Header="Equipment Type" Binding="{Binding EquipmentType}" Width="150"/>
                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
                            <DataGridTextColumn Header="Service" Binding="{Binding Service}" Width="150"/>
                            <DataGridTextColumn Header="Area" Binding="{Binding Area}" Width="100"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                            <DataGridTextColumn Header="Manufacturer" Binding="{Binding Manufacturer}" Width="150"/>
                            <DataGridTextColumn Header="Operating Pressure" Width="130">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="OperatingPressure"/>
                                        <Binding Path="OperatingPressureUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Operating Temp" Width="130">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="OperatingTemperature"/>
                                        <Binding Path="OperatingTemperatureUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Flow Rate" Width="120">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="FlowRate"/>
                                        <Binding Path="FlowRateUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Design Pressure" Width="130">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="DesignPressure"/>
                                        <Binding Path="DesignPressureUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Design Temp" Width="120">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="DesignTemperature"/>
                                        <Binding Path="DesignTemperatureUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Power/Capacity" Width="130">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="PowerOrCapacity"/>
                                        <Binding Path="PowerOrCapacityUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Lines">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="LinesProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="LinesProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="LinesProjectTaggingModeTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                        <Button Content="Add Line" Width="100" Height="30" Margin="5" Click="AddLine_Click"/>
                        <Button Content="Edit Line" Width="100" Height="30" Margin="5" Click="EditLine_Click"/>
                        <Button Content="Delete Line" Width="100" Height="30" Margin="5" Click="DeleteLine_Click"/>
                        <Button Content="Import from Excel" Width="130" Height="30" Margin="5" Click="ImportLines_Click" Background="LightGreen"/>
                        <Button Content="Export to Excel" Width="120" Height="30" Margin="5" Click="ExportLines_Click"/>
                        <Button Content="Download Template" Width="130" Height="30" Margin="5" Click="DownloadLinesTemplate_Click" Background="LightYellow"/>
                        <Button Content="Refresh" Width="80" Height="30" Margin="5" Click="RefreshLines_Click"/>
                    </StackPanel>

                    <!-- Lines DataGrid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="LinesDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Line Number" Binding="{Binding LineNumber}" Width="150"/>
                            <DataGridTextColumn Header="Service" Binding="{Binding Service}" Width="*"/>
                            <DataGridTextColumn Header="Fluid Type" Binding="{Binding FluidType}" Width="120"/>
                            <DataGridTextColumn Header="Size" Binding="{Binding NominalSize}" Width="80"/>
                            <DataGridTextColumn Header="Material Spec" Binding="{Binding MaterialSpec}" Width="120"/>
                            <DataGridTextColumn Header="Schedule" Binding="{Binding PipeSchedule}" Width="100"/>
                            <DataGridTextColumn Header="From Equipment" Binding="{Binding FromEquipment.TagNumber}" Width="130"/>
                            <DataGridTextColumn Header="To Equipment" Binding="{Binding ToEquipment.TagNumber}" Width="130"/>
                            <DataGridTextColumn Header="Design Pressure" Width="130">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="DesignPressure"/>
                                        <Binding Path="DesignPressureUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Design Temp" Width="120">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="DesignTemperature"/>
                                        <Binding Path="DesignTemperatureUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Instruments">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="InstrumentsProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="InstrumentsProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="InstrumentsProjectTaggingModeTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                        <Button Content="Add Instrument" Width="120" Height="30" Margin="5" Click="AddInstrument_Click"/>
                        <Button Content="Edit Instrument" Width="120" Height="30" Margin="5" Click="EditInstrument_Click"/>
                        <Button Content="Delete Instrument" Width="130" Height="30" Margin="5" Click="DeleteInstrument_Click"/>
                        <Button Content="Import from Excel" Width="130" Height="30" Margin="5" Click="ImportInstruments_Click" Background="LightGreen"/>
                        <Button Content="Export to Excel" Width="120" Height="30" Margin="5" Click="ExportInstruments_Click"/>
                        <Button Content="Download Template" Width="130" Height="30" Margin="5" Click="DownloadInstrumentsTemplate_Click" Background="LightYellow"/>
                        <Button Content="Refresh" Width="80" Height="30" Margin="5" Click="RefreshInstruments_Click"/>
                    </StackPanel>

                    <!-- Instruments DataGrid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="InstrumentsDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Tag Number" Binding="{Binding TagNumber}" Width="150"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding InstrumentType}" Width="120"/>
                            <DataGridTextColumn Header="Measurement" Binding="{Binding MeasurementType}" Width="120"/>
                            <DataGridTextColumn Header="Range Min" Binding="{Binding RangeMin}" Width="100"/>
                            <DataGridTextColumn Header="Range Max" Binding="{Binding RangeMax}" Width="100"/>
                            <DataGridTextColumn Header="Units" Binding="{Binding Units}" Width="80"/>
                            <DataGridTextColumn Header="Accuracy" Binding="{Binding Accuracy}" Width="100"/>
                            <DataGridTextColumn Header="Equipment" Binding="{Binding ParentEquipment.TagNumber}" Width="130"/>
                            <DataGridTextColumn Header="Line" Binding="{Binding Line.LineNumber}" Width="130"/>
                            <DataGridTextColumn Header="Loop Number" Binding="{Binding LoopNumber}" Width="100"/>
                            <DataGridTextColumn Header="Location" Binding="{Binding Location}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Drawings">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="DrawingsProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="DrawingsProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="DrawingsProjectNameTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                        <Button Content="Import Drawing" Width="120" Height="30" Margin="5" Click="ImportDrawing_Click"/>
                        <Button Content="View in AutoCAD" Width="130" Height="30" Margin="5" Click="ViewDrawing_Click"/>
                        <Button Content="Export List" Width="100" Height="30" Margin="5" Click="ExportDrawingList_Click"/>
                        <Button Content="Delete" Width="80" Height="30" Margin="5" Click="DeleteDrawing_Click"/>
                        <Button Content="Refresh" Width="80" Height="30" Margin="5" Click="RefreshDrawings_Click"/>
                    </StackPanel>

                    <!-- Drawings Grid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="DrawingsDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Drawing Number" Binding="{Binding DrawingNumber}" Width="150"/>
                            <DataGridTextColumn Header="Title" Binding="{Binding DrawingTitle}" Width="*"/>
                            <DataGridTextColumn Header="Revision" Binding="{Binding Revision}" Width="80"/>
                            <DataGridTextColumn Header="Version" Binding="{Binding VersionNumber}" Width="80"/>
                            <DataGridTextColumn Header="Import Date" Binding="{Binding ImportDate, StringFormat='{}{0:yyyy-MM-dd HH:mm}'}" Width="140"/>
                            <DataGridTextColumn Header="Equipment Count" Binding="{Binding Equipment.Count}" Width="120"/>
                            <DataGridTextColumn Header="File Name" Binding="{Binding FileName}" Width="200"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Validation">
                <Grid>
                    <TextBlock Text="Validation and design rule checking will be implemented here"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontSize="16"
                               Foreground="Gray"/>
                </Grid>
            </TabItem>

            <TabItem Header="Audit Log">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="AuditLogProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="AuditLogProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="AuditLogProjectNameTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Filters -->
                    <GroupBox Grid.Row="1" Header="Filters" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="Entity Type:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox Grid.Column="1" Name="EntityTypeFilterComboBox" Height="25" Margin="0,0,10,0" SelectionChanged="AuditLogFilter_Changed">
                                <ComboBoxItem Content="All" IsSelected="True"/>
                                <ComboBoxItem Content="Equipment"/>
                                <ComboBoxItem Content="Line"/>
                                <ComboBoxItem Content="Instrument"/>
                                <ComboBoxItem Content="Drawing"/>
                                <ComboBoxItem Content="Project"/>
                            </ComboBox>

                            <TextBlock Grid.Column="2" Text="Action:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox Grid.Column="3" Name="ActionFilterComboBox" Height="25" Margin="0,0,10,0" SelectionChanged="AuditLogFilter_Changed">
                                <ComboBoxItem Content="All" IsSelected="True"/>
                                <ComboBoxItem Content="Created"/>
                                <ComboBoxItem Content="Updated"/>
                                <ComboBoxItem Content="Deleted"/>
                                <ComboBoxItem Content="Batch Tagged"/>
                                <ComboBoxItem Content="Synchronized"/>
                            </ComboBox>

                            <TextBlock Grid.Column="4" Text="Last:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox Grid.Column="5" Name="TimeRangeFilterComboBox" Height="25" Margin="0,0,10,0" SelectionChanged="AuditLogFilter_Changed">
                                <ComboBoxItem Content="24 Hours" IsSelected="True"/>
                                <ComboBoxItem Content="7 Days"/>
                                <ComboBoxItem Content="30 Days"/>
                                <ComboBoxItem Content="All Time"/>
                            </ComboBox>

                            <Button Grid.Column="7" Content="Refresh" Width="80" Height="25" Click="RefreshAuditLog_Click"/>
                        </Grid>
                    </GroupBox>

                    <!-- Audit Log Grid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="AuditLogDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Timestamp" Binding="{Binding Timestamp, StringFormat='{}{0:yyyy-MM-dd HH:mm:ss}'}" Width="140"/>
                            <DataGridTextColumn Header="Entity Type" Binding="{Binding EntityType}" Width="100"/>
                            <DataGridTextColumn Header="Action" Binding="{Binding Action}" Width="100"/>
                            <DataGridTextColumn Header="Performed By" Binding="{Binding PerformedBy}" Width="120"/>
                            <DataGridTextColumn Header="Change Details" Binding="{Binding ChangeDetails}" Width="*"/>
                            <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="150"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock Name="StatusTextBlock" Text="Ready"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
