<Window x:Class="PIDStandardization.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="P&amp;ID Standardization Application" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Menu Grid.Row="0">
            <MenuItem Header="_File">
                <MenuItem Header="_New Project" Click="NewProject_Click"/>
                <MenuItem Header="_Open Project" Click="OpenProject_Click"/>
                <Separator/>
                <MenuItem Header="_Exit" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Project">
                <MenuItem Header="_Settings"/>
                <MenuItem Header="_Tagging Mode"/>
            </MenuItem>
            <MenuItem Header="_Equipment">
                <MenuItem Header="_Add Equipment"/>
                <MenuItem Header="_Tag Equipment"/>
            </MenuItem>
            <MenuItem Header="_Drawings">
                <MenuItem Header="_Import Drawing"/>
                <MenuItem Header="_Manage Drawings"/>
            </MenuItem>
            <MenuItem Header="_Validation">
                <MenuItem Header="_Run Validation"/>
                <MenuItem Header="_Configure Rules"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_Welcome Screen" Click="WelcomeScreen_Click"/>
                <MenuItem Header="_Quick Start Guide" Click="QuickStartGuide_Click"/>
                <MenuItem Header="_Documentation" Click="Documentation_Click"/>
                <Separator/>
                <MenuItem Header="_About" Click="About_Click"/>
            </MenuItem>
        </Menu>

        <!-- Main Content Area -->
        <TabControl Grid.Row="1" Margin="5" Name="MainTabControl" SelectionChanged="MainTabControl_SelectionChanged">
            <TabItem Header="Equipment">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="EquipmentProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="EquipmentProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="EquipmentProjectTaggingModeTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                        <Button Content="Add Equipment" Width="120" Height="30" Margin="5" Click="AddEquipment_Click"/>
                        <Button Content="Edit Equipment" Width="120" Height="30" Margin="5" Click="EditEquipment_Click"/>
                        <Button Content="Delete Equipment" Width="130" Height="30" Margin="5" Click="DeleteEquipment_Click"/>
                        <Button Content="Export to Excel" Width="120" Height="30" Margin="5" Click="ExportEquipment_Click"/>
                        <Button Content="Refresh" Width="80" Height="30" Margin="5" Click="RefreshEquipment_Click"/>
                    </StackPanel>

                    <!-- Equipment Grid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="EquipmentDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Tag Number" Binding="{Binding TagNumber}" Width="150"/>
                            <DataGridTextColumn Header="Equipment Type" Binding="{Binding EquipmentType}" Width="150"/>
                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
                            <DataGridTextColumn Header="Service" Binding="{Binding Service}" Width="150"/>
                            <DataGridTextColumn Header="Area" Binding="{Binding Area}" Width="100"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                            <DataGridTextColumn Header="Manufacturer" Binding="{Binding Manufacturer}" Width="150"/>
                            <DataGridTextColumn Header="Operating Pressure" Width="130">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="OperatingPressure"/>
                                        <Binding Path="OperatingPressureUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Operating Temp" Width="130">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="OperatingTemperature"/>
                                        <Binding Path="OperatingTemperatureUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Flow Rate" Width="120">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="FlowRate"/>
                                        <Binding Path="FlowRateUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Design Pressure" Width="130">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="DesignPressure"/>
                                        <Binding Path="DesignPressureUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Design Temp" Width="120">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="DesignTemperature"/>
                                        <Binding Path="DesignTemperatureUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Power/Capacity" Width="130">
                                <DataGridTextColumn.Binding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="PowerOrCapacity"/>
                                        <Binding Path="PowerOrCapacityUnit"/>
                                    </MultiBinding>
                                </DataGridTextColumn.Binding>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Lines">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="LinesProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="LinesProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="LinesProjectTaggingModeTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                        <Button Content="Add Line" Width="100" Height="30" Margin="5" Click="AddLine_Click"/>
                        <Button Content="Edit Line" Width="100" Height="30" Margin="5" Click="EditLine_Click"/>
                        <Button Content="Delete Line" Width="100" Height="30" Margin="5" Click="DeleteLine_Click"/>
                        <Button Content="Export to Excel" Width="120" Height="30" Margin="5" Click="ExportLines_Click"/>
                        <Button Content="Refresh" Width="80" Height="30" Margin="5" Click="RefreshLines_Click"/>
                    </StackPanel>

                    <!-- Lines DataGrid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="LinesDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Line Number" Binding="{Binding LineNumber}" Width="150"/>
                            <DataGridTextColumn Header="Service" Binding="{Binding Service}" Width="*"/>
                            <DataGridTextColumn Header="Fluid Type" Binding="{Binding FluidType}" Width="120"/>
                            <DataGridTextColumn Header="Size" Binding="{Binding NominalSize}" Width="80"/>
                            <DataGridTextColumn Header="Material Spec" Binding="{Binding MaterialSpec}" Width="120"/>
                            <DataGridTextColumn Header="Schedule" Binding="{Binding PipeSchedule}" Width="100"/>
                            <DataGridTextColumn Header="From Equipment" Binding="{Binding FromEquipment.TagNumber}" Width="130"/>
                            <DataGridTextColumn Header="To Equipment" Binding="{Binding ToEquipment.TagNumber}" Width="130"/>
                            <DataGridTextColumn Header="Design Pressure" Binding="{Binding DesignPressure}" Width="120"/>
                            <DataGridTextColumn Header="Design Temp" Binding="{Binding DesignTemperature}" Width="110"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Instruments">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="InstrumentsProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="InstrumentsProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="InstrumentsProjectTaggingModeTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                        <Button Content="Add Instrument" Width="120" Height="30" Margin="5" Click="AddInstrument_Click"/>
                        <Button Content="Edit Instrument" Width="120" Height="30" Margin="5" Click="EditInstrument_Click"/>
                        <Button Content="Delete Instrument" Width="130" Height="30" Margin="5" Click="DeleteInstrument_Click"/>
                        <Button Content="Export to Excel" Width="120" Height="30" Margin="5" Click="ExportInstruments_Click"/>
                        <Button Content="Refresh" Width="80" Height="30" Margin="5" Click="RefreshInstruments_Click"/>
                    </StackPanel>

                    <!-- Instruments DataGrid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="InstrumentsDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Tag Number" Binding="{Binding TagNumber}" Width="150"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding InstrumentType}" Width="120"/>
                            <DataGridTextColumn Header="Measurement" Binding="{Binding MeasurementType}" Width="120"/>
                            <DataGridTextColumn Header="Range Min" Binding="{Binding RangeMin}" Width="100"/>
                            <DataGridTextColumn Header="Range Max" Binding="{Binding RangeMax}" Width="100"/>
                            <DataGridTextColumn Header="Units" Binding="{Binding Units}" Width="80"/>
                            <DataGridTextColumn Header="Accuracy" Binding="{Binding Accuracy}" Width="100"/>
                            <DataGridTextColumn Header="Equipment" Binding="{Binding ParentEquipment.TagNumber}" Width="130"/>
                            <DataGridTextColumn Header="Line" Binding="{Binding Line.LineNumber}" Width="130"/>
                            <DataGridTextColumn Header="Loop Number" Binding="{Binding LoopNumber}" Width="100"/>
                            <DataGridTextColumn Header="Location" Binding="{Binding Location}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Drawings">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="DrawingsProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="DrawingsProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="DrawingsProjectNameTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                        <Button Content="Import Drawing" Width="120" Height="30" Margin="5" Click="ImportDrawing_Click"/>
                        <Button Content="View in AutoCAD" Width="130" Height="30" Margin="5" Click="ViewDrawing_Click"/>
                        <Button Content="Export List" Width="100" Height="30" Margin="5" Click="ExportDrawingList_Click"/>
                        <Button Content="Delete" Width="80" Height="30" Margin="5" Click="DeleteDrawing_Click"/>
                        <Button Content="Refresh" Width="80" Height="30" Margin="5" Click="RefreshDrawings_Click"/>
                    </StackPanel>

                    <!-- Drawings Grid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="DrawingsDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Drawing Number" Binding="{Binding DrawingNumber}" Width="150"/>
                            <DataGridTextColumn Header="Title" Binding="{Binding DrawingTitle}" Width="*"/>
                            <DataGridTextColumn Header="Revision" Binding="{Binding Revision}" Width="80"/>
                            <DataGridTextColumn Header="Version" Binding="{Binding VersionNumber}" Width="80"/>
                            <DataGridTextColumn Header="Import Date" Binding="{Binding ImportDate, StringFormat='{}{0:yyyy-MM-dd HH:mm}'}" Width="140"/>
                            <DataGridTextColumn Header="Equipment Count" Binding="{Binding Equipment.Count}" Width="120"/>
                            <DataGridTextColumn Header="File Name" Binding="{Binding FileName}" Width="200"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Validation">
                <Grid>
                    <TextBlock Text="Validation and design rule checking will be implemented here"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontSize="16"
                               Foreground="Gray"/>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock Name="StatusTextBlock" Text="Ready"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
