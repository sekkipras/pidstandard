<Window x:Class="PIDStandardization.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="P&amp;ID Standardization Application" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Menu Grid.Row="0">
            <MenuItem Header="_File">
                <MenuItem Header="_New Project" Click="NewProject_Click"/>
                <MenuItem Header="_Open Project" Click="OpenProject_Click"/>
                <Separator/>
                <MenuItem Header="_Exit" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="_Project">
                <MenuItem Header="_Settings"/>
                <MenuItem Header="_Tagging Mode"/>
            </MenuItem>
            <MenuItem Header="_Equipment">
                <MenuItem Header="_Add Equipment"/>
                <MenuItem Header="_Tag Equipment"/>
            </MenuItem>
            <MenuItem Header="_Drawings">
                <MenuItem Header="_Import Drawing"/>
                <MenuItem Header="_Manage Drawings"/>
            </MenuItem>
            <MenuItem Header="_Validation">
                <MenuItem Header="_Run Validation"/>
                <MenuItem Header="_Configure Rules"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_Welcome Screen" Click="WelcomeScreen_Click"/>
                <MenuItem Header="_Quick Start Guide" Click="QuickStartGuide_Click"/>
                <MenuItem Header="_Documentation" Click="Documentation_Click"/>
                <Separator/>
                <MenuItem Header="_About" Click="About_Click"/>
            </MenuItem>
        </Menu>

        <!-- Main Content Area -->
        <TabControl Grid.Row="1" Margin="5" Name="MainTabControl" SelectionChanged="MainTabControl_SelectionChanged">
            <TabItem Header="Projects">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5">
                        <Button Content="New Project" Width="100" Height="30" Margin="5" Click="NewProject_Click"/>
                        <Button Content="Load Project" Width="100" Height="30" Margin="5" Click="OpenProject_Click"/>
                    </StackPanel>

                    <DataGrid Grid.Row="1" Margin="5" Name="ProjectsDataGrid" AutoGenerateColumns="False" IsReadOnly="True" SelectionChanged="ProjectsDataGrid_SelectionChanged">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Project Name" Binding="{Binding ProjectName}" Width="*"/>
                            <DataGridTextColumn Header="Project Number" Binding="{Binding ProjectNumber}" Width="150"/>
                            <DataGridTextColumn Header="Client" Binding="{Binding Client}" Width="200"/>
                            <DataGridTextColumn Header="Tagging Mode" Binding="{Binding TaggingMode}" Width="120"/>
                            <DataGridTextColumn Header="Created Date" Binding="{Binding CreatedDate, StringFormat='{}{0:yyyy-MM-dd}'}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Equipment">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="EquipmentProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="EquipmentProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="EquipmentProjectTaggingModeTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                        <Button Content="Add Equipment" Width="120" Height="30" Margin="5" Click="AddEquipment_Click"/>
                        <Button Content="Refresh" Width="80" Height="30" Margin="5" Click="RefreshEquipment_Click"/>
                    </StackPanel>

                    <!-- Equipment Grid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="EquipmentDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Tag Number" Binding="{Binding TagNumber}" Width="150"/>
                            <DataGridTextColumn Header="Equipment Type" Binding="{Binding EquipmentType}" Width="150"/>
                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*"/>
                            <DataGridTextColumn Header="Service" Binding="{Binding Service}" Width="150"/>
                            <DataGridTextColumn Header="Area" Binding="{Binding Area}" Width="100"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                            <DataGridTextColumn Header="Manufacturer" Binding="{Binding Manufacturer}" Width="150"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Drawings">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Project Selection -->
                    <GroupBox Grid.Row="0" Header="Select Project" Margin="5">
                        <Grid Margin="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox Grid.Column="0" Name="DrawingsProjectComboBox"
                                      DisplayMemberPath="ProjectName"
                                      SelectionChanged="DrawingsProjectComboBox_SelectionChanged"
                                      Height="25" Margin="0,0,5,0"/>
                            <TextBlock Grid.Column="1" Name="DrawingsProjectNameTextBlock"
                                       VerticalAlignment="Center" FontWeight="Bold" Foreground="DarkBlue"
                                       Margin="10,0,0,0"/>
                        </Grid>
                    </GroupBox>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                        <Button Content="Import Drawing" Width="120" Height="30" Margin="5" Click="ImportDrawing_Click"/>
                        <Button Content="View in AutoCAD" Width="130" Height="30" Margin="5" Click="ViewDrawing_Click"/>
                        <Button Content="Export List" Width="100" Height="30" Margin="5" Click="ExportDrawingList_Click"/>
                        <Button Content="Delete" Width="80" Height="30" Margin="5" Click="DeleteDrawing_Click"/>
                        <Button Content="Refresh" Width="80" Height="30" Margin="5" Click="RefreshDrawings_Click"/>
                    </StackPanel>

                    <!-- Drawings Grid -->
                    <DataGrid Grid.Row="2" Margin="5" Name="DrawingsDataGrid"
                              AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Drawing Number" Binding="{Binding DrawingNumber}" Width="150"/>
                            <DataGridTextColumn Header="Title" Binding="{Binding DrawingTitle}" Width="*"/>
                            <DataGridTextColumn Header="Revision" Binding="{Binding Revision}" Width="80"/>
                            <DataGridTextColumn Header="Version" Binding="{Binding VersionNumber}" Width="80"/>
                            <DataGridTextColumn Header="Import Date" Binding="{Binding ImportDate, StringFormat='{}{0:yyyy-MM-dd HH:mm}'}" Width="140"/>
                            <DataGridTextColumn Header="Equipment Count" Binding="{Binding Equipment.Count}" Width="120"/>
                            <DataGridTextColumn Header="File Name" Binding="{Binding FileName}" Width="200"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            <TabItem Header="Validation">
                <Grid>
                    <TextBlock Text="Validation and design rule checking will be implemented here"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontSize="16"
                               Foreground="Gray"/>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock Name="StatusTextBlock" Text="Ready"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
